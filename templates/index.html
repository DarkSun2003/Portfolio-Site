<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio // Developer</title>

    <!-- --- SEO & SOCIAL MEDIA --- -->
    <meta name="description"
        content="Portfolio of a Full Stack Developer specialized in Django, React, and Three.js. Explore my projects and tech stack.">
    <meta name="keywords" content="Developer, Portfolio, Django, Python, Web3, React, JavaScript">
    <meta name="author" content="Your Name">
    <meta property="og:title" content="Portfolio // Developer">
    <meta property="og:description" content="Check out my latest projects, certifications, and technical skills.">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/030305/00d4ff?text=Developer+Portfolio">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Portfolio // Developer">
    <meta name="twitter:description" content="Full Stack Developer Portfolio.">
    <meta name="twitter:image" content="https://via.placeholder.com/1200x630/030305/00d4ff?text=Developer+Portfolio">

    <!-- --- GSAP SCRIPTS --- -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <!-- Three.js Import Map -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <link
        href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">

    <style>
        :root {
            --bg: #030305;
            --glass: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-highlight: rgba(255, 255, 255, 0.15);
            --text-main: #ffffff;
            --text-muted: #8888aa;
            --accent-primary: #7000ff;
            --accent-secondary: #00d4ff;
            --discord-color: #5865F2;
            --insta-color: #E1306C;
            --linkedin-color: #0077b5;
            --whatsapp-color: #25D366;
            --skill-backend: #bc13fe;
            --skill-frontend: #00f3ff;
            --skill-tools: #ff9100;
            --skill-soft: #ffffff;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            color: var(--text-main);
            font-family: 'Manrope', sans-serif;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        main>section {
            content-visibility: auto;
            contain-intrinsic-size: 0px 2000px;
        }

        /* Shimmer Text */
        .shimmer-text {
            background: linear-gradient(to right, #ffffff 0%, #00d4ff 50%, #ffffff 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 5s linear infinite;
        }

        @keyframes shine {
            to {
                background-position: 200% center;
            }
        }

        /* Icons Float Animation */
        @keyframes floatIcon {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-6px);
            }
        }

        /* Layout Styles */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .container {
            position: relative;
            z-index: 10;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 40px;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 40px 0;
        }

        .brand {
            font-weight: 800;
            font-size: 1.5rem;
            letter-spacing: -1px;
            background: linear-gradient(135deg, #fff, #888);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 100px;
            border: 1px solid var(--glass-border);
            background: var(--glass);
            color: white;
            font-family: 'Manrope', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            margin-left: 10px;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: var(--glass-highlight);
            transform: translateY(-2px);
        }

        .btn.primary {
            background: white;
            color: black;
            border: none;
        }

        .btn.primary:hover {
            background: var(--accent-secondary);
            color: white;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.4);
        }

        .hero {
            height: 80vh;
            display: flex;
            align-items: center;
            gap: 50px;
        }

        /* Profile */
        .profile-wrapper {
            position: relative;
            width: 300px;
            height: 300px;
            flex-shrink: 0;
            cursor: pointer;
            transition: transform 0.3s;
        }

        body:not(.admin-mode) .profile-wrapper {
            cursor: default;
        }

        body.admin-mode .profile-wrapper:hover {
            transform: scale(1.05);
        }

        .profile-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 30px;
            border: 1px solid var(--glass-border);
        }

        .upload-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 30px;
            opacity: 0;
            transition: 0.3s;
            color: white;
            font-weight: 600;
            backdrop-filter: blur(5px);
        }

        body.admin-mode .profile-wrapper:hover .upload-overlay {
            opacity: 1;
        }

        h1 {
            font-size: 4rem;
            line-height: 1.1;
            font-weight: 800;
            margin: 0 0 20px 0;
            letter-spacing: -2px;
        }

        .role-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 50px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 30px;
        }

        p.bio {
            font-size: 1.2rem;
            color: var(--text-muted);
            line-height: 1.6;
            max-width: 600px;
            margin-bottom: 40px;
        }

        /* --- TECH STACK --- */
        .skills-container {
            text-align: center;
            margin-top: 100px;
        }

        .section-header {
            margin: 100px 0 60px 0;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin: 0;
            color: white;
        }

        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .skill-chip {
            background: rgba(10, 10, 15, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
            text-align: left;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            /* Updated for 3D Feel */
            transform-style: preserve-3d;
            will-change: transform, opacity;
        }

        .skill-chip::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--chip-color);
            box-shadow: 0 0 10px var(--chip-color);
            transition: width 0.3s ease;
            z-index: 1;
        }

        .skill-chip:hover {
            transform: translateY(-10px) scale(1.05) !important;
            background: rgba(20, 20, 30, 0.9);
            border-color: var(--chip-color);
            box-shadow: 0 15px 40px -10px var(--chip-color);
            z-index: 10;
        }

        .skill-cat {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--chip-color);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 700;
        }

        .skill-name {
            font-size: 1.1rem;
            font-weight: 700;
            color: white;
            line-height: 1.2;
            position: relative;
            z-index: 2;
        }

        /* Grid & Cards */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 100px;
        }

        .card {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 40px;
            transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
            opacity: 0;
            /* Hidden initially */
            transform: translateY(60px);
            /* Hidden initially */
        }

        .card:hover {
            transform: translateY(-10px) !important;
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.3);
        }

        .card h3 {
            font-size: 1.5rem;
            margin: 0 0 15px 0;
            color: white;
        }

        .card p {
            color: var(--text-muted);
            line-height: 1.6;
            margin-bottom: 25px;
        }

        /* --- CONTACT --- */
        .contact-section {
            text-align: center;
            padding: 60px 0 100px 0;
        }

        .social-grid {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .social-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 30px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            transition: 0.3s;
            backdrop-filter: blur(10px);
            opacity: 0;
            /* Hidden initially */
            transform: translateY(20px);
            /* Hidden initially */
        }

        .social-btn svg {
            width: 26px;
            height: 26px;
            fill: currentColor;
            vertical-align: middle;
            animation: floatIcon 3s ease-in-out infinite;
        }

        .social-btn.discord:hover {
            border-color: var(--discord-color);
            color: var(--discord-color);
            box-shadow: 0 0 15px var(--discord-color);
        }

        .social-btn.instagram:hover {
            border-color: var(--insta-color);
            color: var(--insta-color);
            box-shadow: 0 0 15px var(--insta-color);
        }

        .social-btn.linkedin:hover {
            border-color: var(--linkedin-color);
            color: var(--linkedin-color);
            box-shadow: 0 0 15px var(--linkedin-color);
        }

        .social-btn.whatsapp:hover {
            border-color: var(--whatsapp-color);
            color: var(--whatsapp-color);
            box-shadow: 0 0 15px var(--whatsapp-color);
        }

        /* Admin */
        .admin-only {
            display: none;
        }

        body.admin-mode .admin-only {
            display: inline-block;
        }

        .toast {
            position: fixed;
            bottom: 40px;
            right: 40px;
            background: rgba(20, 20, 30, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid var(--accent-secondary);
            padding: 20px 30px;
            border-radius: 12px;
            transform: translateY(100px);
            transition: 0.5s;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
        }

        @media (max-width: 768px) {
            .hero {
                flex-direction: column;
                text-align: center;
                height: auto;
                padding-top: 50px;
            }

            .container {
                padding: 0 20px;
            }

            h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>

<body>

    <div id="canvas-container"></div>

    <div class="container">
        <nav>
            <div class="brand">DEV.PORTFOLIO</div>
            <div class="controls">
                {% if is_admin %}
                <a href="/admin/" class="btn">Admin Panel</a>
                <a href="/admin/logout/" class="btn">Logout</a>
                {% endif %}
            </div>
        </nav>

        <main>
            <!-- HERO SECTION -->
            <section class="hero">
                <div class="profile-wrapper" id="profileWrapper" onclick="triggerUpload()">
                    <img src="" id="heroImage" class="profile-img" alt="Profile" decoding="async">
                    <div class="upload-overlay admin-only">
                        Click to Change Photo
                    </div>
                </div>
                <!-- Hidden file input -->
                <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="uploadImage(this)">

                <!-- GSAP HERO CONTENT -->
                <div class="hero-content">
                    <div class="role-badge" id="dispRole">Loading Role...</div>
                    <h1 id="dispName" class="shimmer-text">Loading Name...</h1>
                    <p class="bio" id="dispBio">Loading Bio...</p>
                    <p style="font-size: 0.9rem; color: var(--accent-secondary);">
                        <a href="https://github.com/DarkSun2003" target="_blank"
                            style="color: inherit; text-decoration: none;">Connect on GitHub &rarr;</a>
                    </p>
                </div>
            </section>

            <!-- SKILLS SECTION -->
            <section class="skills-container">
                <div class="section-header gs-reveal">
                    <h2 class="section-title">Tech Stack</h2>
                </div>
                <div class="skills-grid" id="skillsGrid"></div>
            </section>

            <div class="section-header gs-reveal">
                <h2 class="section-title">Projects</h2>
                <a href="https://github.com/DarkSun2003?tab=repositories" target="_blank" class="btn"
                    style="font-size: 0.8rem;">View GitHub Profile</a>
            </div>
            <div class="grid" id="projectGrid"></div>

            <div class="section-header gs-reveal">
                <h2 class="section-title">Certifications</h2>
            </div>
            <div class="grid" id="certGrid"></div>

            <!-- CONTACT SECTION -->
            <section class="contact-section">
                <h2 class="section-title gs-reveal">Get In Touch</h2>
                <div class="social-grid" id="socialGrid"></div>
                <p style="margin-top:30px; color:var(--text-muted); font-size:1rem;" class="gs-reveal">Let's build your
                    dream together</p>
            </section>
        </main>
    </div>

    <div class="toast" id="toast">Action Complete</div>

    <!-- THREE.JS BACKGROUND -->
    <script type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x030305, 0.02);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true, powerPreference: "high-performance" });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        const isMobile = window.innerWidth < 768;
        const particlesCount = isMobile ? 500 : 2000;

        const particlesGeometry = new THREE.BufferGeometry();
        const posArray = new Float32Array(particlesCount * 3);
        const colorsArray = new Float32Array(particlesCount * 3);
        const color1 = new THREE.Color(0x7000ff);
        const color2 = new THREE.Color(0x00d4ff);

        for (let i = 0; i < particlesCount * 3; i += 3) {
            const r = 10 * Math.cbrt(Math.random());
            const theta = Math.random() * 2 * Math.PI;
            const phi = Math.acos(2 * Math.random() - 1);

            posArray[i] = r * Math.sin(phi) * Math.cos(theta);
            posArray[i + 1] = r * Math.sin(phi) * Math.sin(theta);
            posArray[i + 2] = r * Math.cos(phi);

            const mixedColor = Math.random() > 0.5 ? color1 : color2;
            colorsArray[i] = mixedColor.r; colorsArray[i + 1] = mixedColor.g; colorsArray[i + 2] = mixedColor.b;
        }

        particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colorsArray, 3));
        const particlesMaterial = new THREE.PointsMaterial({ size: 0.08, vertexColors: true, transparent: true, opacity: 0.8, blending: THREE.AdditiveBlending });
        const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
        scene.add(particlesMesh);

        camera.position.z = 20;

        let composer;
        const renderScene = new RenderPass(scene, camera);

        if (!isMobile) {
            const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
            bloomPass.threshold = 0; bloomPass.strength = 1.2; bloomPass.radius = 0.5;
            composer = new EffectComposer(renderer);
            composer.addPass(renderScene);
            composer.addPass(bloomPass);
        }

        let mouseX = 0;
        let mouseY = 0;
        let targetX = 0;
        let targetY = 0;
        const windowHalfX = window.innerWidth / 2;
        const windowHalfY = window.innerHeight / 2;

        document.addEventListener('mousemove', (event) => {
            if (!isMobile) {
                mouseX = (event.clientX - windowHalfX);
                mouseY = (event.clientY - windowHalfY);
            }
        });

        function animate() {
            requestAnimationFrame(animate);
            particlesMesh.rotation.y += 0.001;
            particlesMesh.rotation.x += 0.0005;
            targetX = mouseX * 0.001;
            targetY = mouseY * 0.001;
            particlesMesh.rotation.y += 0.05 * (targetX - particlesMesh.rotation.y);
            particlesMesh.rotation.x += 0.05 * (targetY - particlesMesh.rotation.x);
            if (isMobile) {
                renderer.render(scene, camera);
            } else {
                composer.render();
            }
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            if (composer) composer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>

    <!-- APP LOGIC & GSAP ANIMATIONS -->
    <script>
        // 1. INIT GSAP
        gsap.registerPlugin(ScrollTrigger);

        let isAdmin = {{ is_admin| lower }};
        let currentProfileId = null;
        if (isAdmin) document.body.classList.add('admin-mode');

        async function fetchData() {
            try {
                const pRes = await fetch('/api/profile/');
                if (!pRes.ok) throw new Error(`Profile Status: ${pRes.status}`);
                const pData = await pRes.json();
                currentProfileId = pData.id;
                document.getElementById('heroImage').src = pData.profile_pic;
                document.getElementById('dispName').innerText = pData.full_name || "Admin Setup Required";
                document.getElementById('dispRole').innerText = pData.role || "Role";
                document.getElementById('dispBio').innerText = pData.bio || "Please add a bio in the Admin Panel.";

                // --- RENDER CONTACTS ---
                const socialGrid = document.getElementById('socialGrid');
                let socialHTML = '';
                let socialIndex = 0;
                const discordIcon = `<svg viewBox="0 0 24 24"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/></svg>`;
                const instaIcon = `<svg viewBox="0 0 24 24"><path d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/></svg>`;
                const linkedinIcon = `<svg viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>`;
                const whatsappIcon = `<svg viewBox="0 0 24 24"><path d="M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2.05 22l5.25-1.38c1.45.79 3.08 1.21 4.74 1.21 5.46 0 9.91-4.45 9.91-9.91 0-2.65-1.03-5.14-2.9-7.01A9.816 9.816 0 0 0 12.04 2m.01 1.67c2.2 0 4.26.86 5.81 2.41a8.16 8.16 0 0 1 2.41 5.81c0 4.54-3.7 8.23-8.24 8.23-1.48 0-2.93-.39-4.19-1.15l-.3-.17-3.1.81.82-3.02-.19-.31a8.17 8.17 0 0 1-1.26-4.38c0-4.54 3.7-8.23 8.24-8.23m3.34 5.44c-.18-.09-1.07-.53-1.24-.59-.17-.06-.29-.09-.41.09-.13.18-.5.59-.61.71-.12.12-.24.14-.42.05-.18-.09-.76-.28-1.45-.9-.54-.48-.9-1.07-1.01-1.25-.11-.17-.01-.27.08-.36.08-.08.18-.2.27-.31.09-.1.12-.17.18-.29.06-.11.03-.21-.01-.3-.04-.09-.18-.42-.25-.58-.07-.16-.14-.14-.23-.14h-.19c-.06 0-.17.02-.26.11-.09.09-.34.33-.34.81 0 .48.35.95.4 1.02.05.06.68 1.04 1.65 1.46.23.1.41.16.55.2.23.07.44.06.6.04.19-.02.57-.23.65-.46.08-.22.08-.41.06-.45-.02-.04-.08-.09-.26-.18"/></svg>`;

                if (pData.discord_url) { socialHTML += `<a href="${pData.discord_url}" target="_blank" class="social-btn discord"><svg style="animation-delay: ${socialIndex * 0.5}s">${discordIcon}</svg> Discord</a>`; socialIndex++; }
                if (pData.instagram_url) { socialHTML += `<a href="${pData.instagram_url}" target="_blank" class="social-btn instagram"><svg style="animation-delay: ${socialIndex * 0.5}s">${instaIcon}</svg> Instagram</a>`; socialIndex++; }
                if (pData.linkedin_url) { socialHTML += `<a href="${pData.linkedin_url}" target="_blank" class="social-btn linkedin"><svg style="animation-delay: ${socialIndex * 0.5}s">${linkedinIcon}</svg> LinkedIn</a>`; socialIndex++; }
                if (pData.whatsapp_number) { const cleanNumber = pData.whatsapp_number.replace(/\D/g, ''); socialHTML += `<a href="https://wa.me/${cleanNumber}" target="_blank" class="social-btn whatsapp"><svg style="animation-delay: ${socialIndex * 0.5}s">${whatsappIcon}</svg> WhatsApp</a>`; socialIndex++; }

                socialGrid.innerHTML = socialHTML || '<p style="color:var(--text-muted)">No contacts added yet.</p>';

                // --- SKILLS ---
                const skillsRes = await fetch('/api/skills/');
                if (skillsRes.ok) {
                    const skills = await skillsRes.json();
                    const skillsGrid = document.getElementById('skillsGrid');

                    if (skills.length === 0) {
                        skillsGrid.innerHTML = '<p style="color:var(--text-muted); width: 100%; grid-column: 1/-1;">No skills added yet.</p>';
                    } else {
                        const getColor = (cat) => cat === 'Backend' ? 'var(--skill-backend)' : cat === 'Frontend' ? 'var(--skill-frontend)' : cat === 'Tools' ? 'var(--skill-tools)' : 'var(--skill-soft)';
                        const getAbbr = (cat) => cat === 'Backend' ? 'BE' : cat === 'Frontend' ? 'FE' : cat === 'Tools' ? 'TL' : 'OS';

                        skillsGrid.innerHTML = skills.map(s => `
                            <div class="skill-chip" style="--chip-color: ${getColor(s.category)}">
                                <div class="skill-cat">${getAbbr(s.category)}</div>
                                <div class="skill-name">${s.name}</div>
                            </div>
                        `).join('');
                    }
                }

                // --- PROJECTS ---
                const projRes = await fetch('/api/projects/');
                if (projRes.ok) {
                    const projects = await projRes.json();
                    const projGrid = document.getElementById('projectGrid');

                    if (projects.length === 0) {
                        projGrid.innerHTML = '<p style="color:var(--text-muted); text-align:center; grid-column: 1/-1;">No projects found.</p>';
                    } else {
                        projGrid.innerHTML = projects.map(p => `
                            <div class="card">
                                <h3>${p.title}</h3>
                                <p>${p.description}</p>
                                <a href="${p.github_url}" target="_blank" style="color:var(--accent-secondary); text-decoration:none; font-weight:600;">View on GitHub &rarr;</a>
                            </div>
                        `).join('');
                    }
                }

                // --- CERTIFICATES ---
                const certRes = await fetch('/api/certificates/');
                if (certRes.ok) {
                    const certs = await certRes.json();
                    const certGrid = document.getElementById('certGrid');

                    if (certs.length === 0 && !isAdmin) {
                        certGrid.innerHTML = '<p style="color:var(--text-muted)">No certifications listed yet.</p>';
                    } else {
                        certGrid.innerHTML = certs.map(c => {
                            let actionLink = c.credential_file ? `<a href="${c.credential_file}" target="_blank" class="btn primary" style="padding: 8px 16px; font-size: 0.8rem;">View File</a>` : c.credential_url ? `<a href="${c.credential_url}" target="_blank" style="color:var(--accent-secondary); text-decoration:none; font-weight:600;">View Credential &rarr;</a>` : `<span style="color:var(--text-muted); font-size:0.8rem;">(No file provided)</span>`;
                            return `
                            <div class="card">
                                <h3>${c.name}</h3>
                                <p>${c.issuer} | ${c.issue_date}</p>
                                ${actionLink}
                            </div>
                            `;
                        }).join('');
                    }
                }

                // --- RUN GSAP ANIMATIONS AFTER CONTENT LOAD ---
                initAnimations();

            } catch (e) {
                alert("Error loading page: " + e.message);
                console.error(e);
            }
        }

        // 2. UPGRADED GSAP ANIMATION FUNCTION
        function initAnimations() {
            // HERO: Stagger entrance
            const heroTl = gsap.timeline();
            heroTl.from(".hero-content > div", { y: 50, opacity: 0, duration: 1, stagger: 0.15, ease: "power3.out" });
            heroTl.from(".hero-content > h1", { y: 50, opacity: 0, duration: 1, ease: "power3.out" }, "-=0.5");
            heroTl.from(".hero-content > p", { y: 30, opacity: 0, duration: 1, ease: "power3.out" }, "-=0.7");

            // SCROLL TRIGGERS (Text & Headers)
            gsap.utils.toArray('.gs-reveal').forEach(element => {
                gsap.to(element, {
                    scrollTrigger: {
                        trigger: element,
                        start: "top 85%",
                        toggleActions: "play none none reverse"
                    },
                    y: 0,
                    opacity: 1,
                    duration: 0.8,
                    ease: "power2.out"
                });
            });

            // --- UPGRADED SKILLS ANIMATION ---

            // 1. The Entrance: Explosive Ripple from Center
            gsap.fromTo(".skill-chip",
                {
                    scale: 0,
                    opacity: 0,
                    rotation: -15
                },
                {
                    scrollTrigger: {
                        trigger: ".skills-container",
                        start: "top 75%",
                    },
                    scale: 1,
                    opacity: 1,
                    rotation: 0,
                    duration: 1.2,
                    ease: "elastic.out(1, 0.5)", // THE BOUNCE
                    stagger: {
                        amount: 1.5,      // Total time for all chips to appear
                        grid: "auto",     // Calculate grid position
                        from: "center"    // EXPLODE FROM MIDDLE
                    }
                }
            );

            // 2. Add Interactive Hover Physics
            const skills = document.querySelectorAll('.skill-chip');
            skills.forEach((skill) => {
                skill.addEventListener('mouseenter', () => {
                    // Quick aggressive pop on hover
                    gsap.to(skill, { scale: 1.1, duration: 0.3, ease: "back.out(1.7)" });
                    gsap.to(skill.querySelector('.skill-cat'), { opacity: 1, duration: 0.2 });
                });

                skill.addEventListener('mouseleave', () => {
                    gsap.to(skill, { scale: 1, duration: 0.4, ease: "power2.out" });
                });
            });

            // CARDS (Batch animation) - Made slightly faster for snappier feel
            gsap.to(".card", {
                scrollTrigger: {
                    trigger: ".grid",
                    start: "top 85%",
                },
                y: 0,
                opacity: 1,
                duration: 0.6, // Faster
                stagger: 0.08,
                ease: "power3.out"
            });

            // SOCIAL ICONS
            gsap.to(".social-btn", {
                scrollTrigger: {
                    trigger: ".contact-section",
                    start: "top 80%",
                },
                y: 0,
                opacity: 1,
                duration: 0.5,
                stagger: 0.1,
                ease: "back.out(1.2)"
            });
        }

        function triggerUpload() { if (isAdmin) document.getElementById('fileInput').click(); }

        async function uploadImage(input) {
            if (input.files && input.files[0]) {
                const formData = new FormData();
                formData.append('profile_pic', input.files[0]);
                const res = await fetch(`/api/profile/${currentProfileId}/`, { method: 'PUT', body: formData });
                if (res.ok) { showToast("Profile Picture Updated"); fetchData(); } else { showToast("Error uploading image"); }
            }
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 3000);
        }

        fetchData();
    </script>
</body>

</html>